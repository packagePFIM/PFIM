<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Design evaluation and optimization in continuous space</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
margin-bottom: 0em;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Design evaluation and optimization in
continuous space</h1>


<div id="TOC">
<ul>
<li><a href="#overview" id="toc-overview">Overview</a></li>
<li><a href="#design-evaluation" id="toc-design-evaluation">Design
evaluation</a>
<ul>
<li><a href="#define-the-pk-model-linear1infusionsingledose_clv-from-the-library-of-models" id="toc-define-the-pk-model-linear1infusionsingledose_clv-from-the-library-of-models">Define
the PK model <code>Linear1InfusionSingleDose_ClV</code> from the library
of models</a></li>
<li><a href="#define-mu-and-omega-for-each-parameter" id="toc-define-mu-and-omega-for-each-parameter">Define mu and omega for
each parameter</a></li>
<li><a href="#define-the-error-model-to-the-response-pk-resppk" id="toc-define-the-error-model-to-the-response-pk-resppk">Define the
error model to the response PK <code>RespPK</code></a></li>
<li><a href="#define-the-administration-parameters-of-the-response-pk" id="toc-define-the-administration-parameters-of-the-response-pk">Define
the administration parameters of the response PK</a></li>
<li><a href="#define-the-sampling-times-for-the-response-pk-resppk" id="toc-define-the-sampling-times-for-the-response-pk-resppk">Define the
sampling times for the response PK <code>RespPK</code></a></li>
<li><a href="#define-an-arm-called-arm1-of-size-150-with-administration-administrationresppk-and-samplings-samplingtimesresppk" id="toc-define-an-arm-called-arm1-of-size-150-with-administration-administrationresppk-and-samplings-samplingtimesresppk">Define
an arm called <code>arm1</code> of size 150 with administration
<code>administrationRespPK</code> and samplings
<code>samplingTimesRespPK</code></a></li>
<li><a href="#add-the-arm-arm1-to-the-design-design1" id="toc-add-the-arm-arm1-to-the-design-design1">Add the arm
<code>arm1</code> to the design <code>design1</code></a></li>
<li><a href="#evaluate-the-population-individual-and-bayesian-fims" id="toc-evaluate-the-population-individual-and-bayesian-fims">Evaluate
the population, individual and Bayesian FIMs</a></li>
<li><a href="#display-the-results-of-the-design-evaluations" id="toc-display-the-results-of-the-design-evaluations">Display the
results of the design evaluations</a></li>
<li><a href="#create-and-save-the-report-for-the-design-evaluation" id="toc-create-and-save-the-report-for-the-design-evaluation">Create and
save the report for the design evaluation</a></li>
</ul></li>
<li><a href="#design-optimization" id="toc-design-optimization">Design
optimization</a>
<ul>
<li><a href="#create-an-sampling-times" id="toc-create-an-sampling-times">Create an sampling times</a></li>
<li><a href="#define-design-constraints" id="toc-define-design-constraints">Define design constraints</a></li>
<li><a href="#create-the-constraint-arm-and-the-associated-design" id="toc-create-the-constraint-arm-and-the-associated-design">Create the
constraint arm and the associated design</a></li>
<li><a href="#set-the-the-parameters-of-the-pso-algorithm-and-run-the-algorithm-for-the-design-optimization-with-a-population-fim" id="toc-set-the-the-parameters-of-the-pso-algorithm-and-run-the-algorithm-for-the-design-optimization-with-a-population-fim">Set
the the parameters of the PSO algorithm and run the algorithm for the
design optimization with a population FIM</a></li>
<li><a href="#run-the-pso-algorithm-for-the-optimization-with-a-population-fim" id="toc-run-the-pso-algorithm-for-the-optimization-with-a-population-fim">Run
the PSO algorithm for the optimization with a population FIM</a></li>
<li><a href="#display-the-results-of-the-design-optimization" id="toc-display-the-results-of-the-design-optimization">Display the
results of the design optimization</a></li>
<li><a href="#create-and-save-the-report-for-the-design-optimization" id="toc-create-and-save-the-report-for-the-design-optimization">Create
and save the report for the design optimization</a></li>
<li><a href="#set-the-the-parameters-of-the-pgbo-algorithm-and-run-the-algorithm-for-the-design-optimization-with-a-population-fim" id="toc-set-the-the-parameters-of-the-pgbo-algorithm-and-run-the-algorithm-for-the-design-optimization-with-a-population-fim">Set
the the parameters of the PGBO algorithm and run the algorithm for the
design optimization with a population FIM</a></li>
<li><a href="#run-the-pgbo-algorithm-for-the-optimization-with-a-population-fim" id="toc-run-the-pgbo-algorithm-for-the-optimization-with-a-population-fim">Run
the PGBO algorithm for the optimization with a population FIM</a></li>
<li><a href="#display-the-results-of-the-design-optimization-1" id="toc-display-the-results-of-the-design-optimization-1">Display the
results of the design optimization</a></li>
<li><a href="#create-and-save-the-report-for-the-design-optimization-1" id="toc-create-and-save-the-report-for-the-design-optimization-1">Create
and save the report for the design optimization</a></li>
</ul></li>
<li><a href="#set-the-the-parameters-of-the-simplex-algorithm-and-run-the-algorithm-for-the-design-optimization-with-a-population-fim" id="toc-set-the-the-parameters-of-the-simplex-algorithm-and-run-the-algorithm-for-the-design-optimization-with-a-population-fim">Set
the the parameters of the Simplex algorithm and run the algorithm for
the design optimization with a population FIM</a>
<ul>
<li><a href="#display-the-results-of-the-design-optimization-2" id="toc-display-the-results-of-the-design-optimization-2">Display the
results of the design optimization</a></li>
<li><a href="#create-and-save-the-report-for-the-design-optimization-2" id="toc-create-and-save-the-report-for-the-design-optimization-2">Create
and save the report for the design optimization</a></li>
</ul></li>
<li><a href="#references" id="toc-references">References</a></li>
</ul>
</div>

<style type="text/css">
body{
font-size: 11pt;
}
h1.title {
font-size: 40pt;
}
code.r{
font-size: 11pt;
}
body {
max-width: 1600px; margin-left:10px;
line-height: 20px;
}
</style>
<div id="overview" class="section level1">
<h1>Overview</h1>
<p>In this example, we simulate an 1-compartment model with linear
elimination for IV infusion over 1 hour (inspired by <span class="citation">(<a href="#ref-Sukeishi2021">Sukeishi et al.
2022</a>)</span>). One hundred and fifty (150) subjects receive a 400mg
loading dose on the first day, followed by 4 daily doses of 200mg. Blood
samples are taken at the end of the <span class="math inline">\(1^{st}\)</span> infusion (H1), H20, H44, H66 and
H120. By evaluating this design, we will then select 4 sampling times on
intervals (0,48) and (72,120) for an optimal design using PSO (Particle
Swarm Optimization) algorithm. The same optimization problem will also
be run with PGBO (Population Based Genetic Optimization) and Simplex
algorithm.</p>
<p>Reports of the design evaluation and optimization are available at <a href="https://github.com/iame-researchCenter/PFIM" class="uri">https://github.com/iame-researchCenter/PFIM</a></p>
</div>
<div id="design-evaluation" class="section level1">
<h1>Design evaluation</h1>
<div id="define-the-pk-model-linear1infusionsingledose_clv-from-the-library-of-models" class="section level3">
<h3>Define the PK model <code>Linear1InfusionSingleDose_ClV</code> from
the library of models</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>modelFromLibrary <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;PKModel&quot;</span> <span class="ot">=</span> <span class="st">&quot;Linear1InfusionSingleDose_ClV&quot;</span>) </span></code></pre></div>
</div>
<div id="define-mu-and-omega-for-each-parameter" class="section level3">
<h3>Define mu and omega for each parameter</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>modelParameters <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  <span class="fu">ModelParameter</span>( <span class="at">name =</span> <span class="st">&quot;V&quot;</span>,    <span class="at">distribution =</span> <span class="fu">LogNormal</span>( <span class="at">mu =</span> <span class="dv">50</span>, <span class="at">omega =</span> <span class="fu">sqrt</span>( .<span class="dv">26</span> ) ) ),</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="fu">ModelParameter</span>( <span class="at">name =</span> <span class="st">&quot;Cl&quot;</span>,   <span class="at">distribution =</span> <span class="fu">LogNormal</span>( <span class="at">mu =</span> <span class="dv">5</span>, <span class="at">omega =</span> <span class="fu">sqrt</span>( .<span class="dv">34</span> ) ) ) )</span></code></pre></div>
</div>
<div id="define-the-error-model-to-the-response-pk-resppk" class="section level3">
<h3>Define the error model to the response PK <code>RespPK</code></h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>errorModelRespPK <span class="ot">=</span> <span class="fu">Combined1</span>( <span class="at">output =</span> <span class="st">&quot;RespPK&quot;</span>, <span class="at">sigmaInter =</span> <span class="fl">0.5</span>, <span class="at">sigmaSlope =</span> <span class="fu">sqrt</span>( <span class="fl">0.15</span> ) )</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>modelError <span class="ot">=</span> <span class="fu">list</span>( errorModelRespPK )</span></code></pre></div>
</div>
<div id="define-the-administration-parameters-of-the-response-pk" class="section level3">
<h3>Define the administration parameters of the response PK</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>administrationRespPK <span class="ot">=</span> <span class="fu">Administration</span>( <span class="at">outcome =</span> <span class="st">&quot;RespPK&quot;</span>,</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>                                       <span class="at">Tinf =</span> <span class="fu">rep</span>( <span class="dv">1</span>, <span class="dv">5</span> ),</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>                                       <span class="at">timeDose =</span> <span class="fu">seq</span>( <span class="dv">0</span>, <span class="dv">96</span>, <span class="dv">24</span> ),</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>                                       <span class="at">dose =</span> <span class="fu">c</span>( <span class="dv">400</span>, <span class="fu">rep</span>( <span class="dv">200</span>, <span class="dv">4</span> ) ) )</span></code></pre></div>
</div>
<div id="define-the-sampling-times-for-the-response-pk-resppk" class="section level3">
<h3>Define the sampling times for the response PK
<code>RespPK</code></h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>samplingTimesRespPK <span class="ot">=</span> <span class="fu">SamplingTimes</span>( <span class="at">outcome =</span> <span class="st">&quot;RespPK&quot;</span>, </span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>                                     <span class="at">samplings =</span> <span class="fu">c</span>( <span class="dv">1</span>,<span class="dv">12</span>,<span class="dv">24</span>,<span class="dv">44</span>,<span class="dv">72</span>,<span class="dv">120</span> ) )</span></code></pre></div>
</div>
<div id="define-an-arm-called-arm1-of-size-150-with-administration-administrationresppk-and-samplings-samplingtimesresppk" class="section level3">
<h3>Define an arm called <code>arm1</code> of size 150 with
administration <code>administrationRespPK</code> and samplings
<code>samplingTimesRespPK</code></h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>arm1 <span class="ot">=</span> <span class="fu">Arm</span>( <span class="at">name =</span> <span class="st">&quot;arm1&quot;</span>,</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">150</span>,</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>            <span class="at">administrations =</span> <span class="fu">list</span>( administrationRespPK ) ,</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>            <span class="at">samplingTimes   =</span> <span class="fu">list</span>( samplingTimesRespPK ) )</span></code></pre></div>
</div>
<div id="add-the-arm-arm1-to-the-design-design1" class="section level3">
<h3>Add the arm <code>arm1</code> to the design
<code>design1</code></h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>design1 <span class="ot">=</span> <span class="fu">Design</span>( <span class="at">name =</span> <span class="st">&quot;design1&quot;</span>, <span class="at">arms =</span> <span class="fu">list</span>( arm1 ) )</span></code></pre></div>
</div>
<div id="evaluate-the-population-individual-and-bayesian-fims" class="section level3">
<h3>Evaluate the population, individual and Bayesian FIMs</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>evaluationPop <span class="ot">=</span> <span class="fu">Evaluation</span>( <span class="at">name =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>                            <span class="at">modelFromLibrary =</span> modelFromLibrary,</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>                            <span class="at">modelParameters =</span> modelParameters,</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>                            <span class="at">modelError =</span> modelError,</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>                            <span class="at">outputs =</span> <span class="fu">list</span>( <span class="st">&quot;RespPK&quot;</span> ),</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>                            <span class="at">designs =</span> <span class="fu">list</span>( design1 ),</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>                            <span class="at">fimType =</span>  <span class="st">&quot;population&quot;</span>,</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>                            <span class="at">odeSolverParameters =</span> <span class="fu">list</span>( <span class="at">atol =</span> <span class="fl">1e-8</span>, <span class="at">rtol =</span> <span class="fl">1e-8</span> ) )</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>evaluationFIMPop <span class="ot">=</span> <span class="fu">run</span>( evaluationPop )</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>evaluationInd <span class="ot">=</span> <span class="fu">Evaluation</span>( <span class="at">name =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>                            <span class="at">modelFromLibrary =</span> modelFromLibrary,</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>                            <span class="at">modelParameters =</span> modelParameters,</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>                            <span class="at">modelError =</span> modelError,</span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>                            <span class="at">outputs =</span> <span class="fu">list</span>( <span class="st">&quot;RespPK&quot;</span> ),</span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>                            <span class="at">designs =</span> <span class="fu">list</span>( design1 ),</span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>                            <span class="at">fimType =</span> <span class="st">&quot;individual&quot;</span>,</span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a>                            <span class="at">odeSolverParameters =</span> <span class="fu">list</span>( <span class="at">atol =</span> <span class="fl">1e-8</span>, <span class="at">rtol =</span> <span class="fl">1e-8</span> ) )</span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a>evaluationFIMInd <span class="ot">=</span> <span class="fu">run</span>( evaluationInd )</span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a>evaluationBay <span class="ot">=</span> <span class="fu">Evaluation</span>( <span class="at">name =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a>                            <span class="at">modelFromLibrary =</span> modelFromLibrary,</span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a>                            <span class="at">modelParameters =</span> modelParameters,</span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a>                            <span class="at">modelError =</span> modelError,</span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a>                            <span class="at">outputs =</span> <span class="fu">list</span>( <span class="st">&quot;RespPK&quot;</span> ),</span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a>                            <span class="at">designs =</span> <span class="fu">list</span>( design1 ),</span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a>                            <span class="at">fimType =</span> <span class="st">&quot;Bayesian&quot;</span>,</span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a>                            <span class="at">odeSolverParameters =</span> <span class="fu">list</span>( <span class="at">atol =</span> <span class="fl">1e-8</span>, <span class="at">rtol =</span> <span class="fl">1e-8</span> ) )</span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a></span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a>evaluationFIMBay <span class="ot">=</span> <span class="fu">run</span>( evaluationBay )</span></code></pre></div>
</div>
<div id="display-the-results-of-the-design-evaluations" class="section level3">
<h3>Display the results of the design evaluations</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">show</span>( evaluationFIMPop )</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">show</span>( evaluationFIMInd )</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="fu">show</span>( evaluationFIMBay )</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>fisherMatrix <span class="ot">=</span> <span class="fu">getFisherMatrix</span>( evaluationFIMPop )</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="fu">getCorrelationMatrix</span>( evaluationFIMPop )</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="fu">getSE</span>( evaluationFIMPop )</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="fu">getRSE</span>( evaluationFIMPop )</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="fu">getShrinkage</span>( evaluationFIMPop )</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="fu">getDeterminant</span>( evaluationFIMPop )</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="fu">getDcriterion</span>( evaluationFIMPop )</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>plotOptions <span class="ot">=</span> <span class="fu">list</span>( <span class="at">unitTime =</span> <span class="fu">c</span>(<span class="st">&quot;hour&quot;</span>), <span class="at">unitOutcomes =</span> <span class="fu">c</span>(<span class="st">&quot;mcg/mL&quot;</span>)  )</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a>plotEvaluation <span class="ot">=</span> <span class="fu">plotEvaluation</span>( evaluationFIMPop, plotOptions )</span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a>plotSensitivityIndices <span class="ot">=</span> <span class="fu">plotSensitivityIndices</span>( evaluationFIMPop, plotOptions )</span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a>SE <span class="ot">=</span> <span class="fu">plotSE</span>( evaluationFIMPop )</span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a>RSE <span class="ot">=</span> <span class="fu">plotRSE</span>( evaluationFIMPop )</span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a><span class="co"># examples</span></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a>plotOutcomesEvaluationRespPK <span class="ot">=</span> plotEvaluation[[<span class="st">&quot;design1&quot;</span>]][[<span class="st">&quot;arm1&quot;</span>]][[<span class="st">&quot;RespPK&quot;</span>]]</span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a>plotSensitivityIndice_RespPK_Cl <span class="ot">=</span>  plotSensitivityIndices[[<span class="st">&quot;design1&quot;</span>]][[<span class="st">&quot;arm1&quot;</span>]][[<span class="st">&quot;RespPK&quot;</span>]][[<span class="st">&quot;V&quot;</span>]]</span></code></pre></div>
</div>
<div id="create-and-save-the-report-for-the-design-evaluation" class="section level3">
<h3>Create and save the report for the design evaluation</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>outputPath <span class="ot">=</span> <span class="fu">getwd</span>()</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>plotOptions <span class="ot">=</span> <span class="fu">list</span>( <span class="at">unitTime=</span><span class="fu">c</span>(<span class="st">&quot;hour&quot;</span>), <span class="at">unitResponses=</span> <span class="fu">c</span>(<span class="st">&quot;mcg/mL&quot;</span>) )</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>outputFile <span class="ot">=</span> <span class="st">&quot;Example02_EvaluationPopFIM.html&quot;</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="fu">Report</span>( evaluationFIMPop, outputPath, outputFile, plotOptions )</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>outputFile <span class="ot">=</span> <span class="st">&quot;Example02_EvaluationIndFIM.html&quot;</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="fu">Report</span>( evaluationFIMInd, outputPath, outputFile, plotOptions )</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>outputFile <span class="ot">=</span> <span class="st">&quot;Example02_EvaluationBayFIM.html&quot;</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="fu">Report</span>( evaluationFIMBay, outputPath, outputFile, plotOptions )</span></code></pre></div>
</div>
</div>
<div id="design-optimization" class="section level1">
<h1>Design optimization</h1>
<div id="create-an-sampling-times" class="section level3">
<h3>Create an sampling times</h3>
<p>We create sampling times that will be used in the initial design for
comparison during the optimization process. As PSO does not optimize the
dose regimens, we keep the same administration.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>samplingTimesRespPK <span class="ot">=</span> <span class="fu">SamplingTimes</span>( <span class="at">outcome =</span> <span class="st">&quot;RespPK&quot;</span>, <span class="at">samplings =</span> <span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">48</span>, <span class="dv">72</span>, <span class="dv">120</span>  ) )</span></code></pre></div>
</div>
<div id="define-design-constraints" class="section level3">
<h3>Define design constraints</h3>
<p>We define sampling times constraints that aim to select 4 sampling
times: 2 within the interval [1,48], and 2 within [72, 120], with at
least a delay of 5 between two points.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>samplingConstraintsRespPK  <span class="ot">=</span> <span class="fu">SamplingTimeConstraints</span>( <span class="at">outcome =</span> <span class="st">&quot;RespPK&quot;</span>,</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>                                                      <span class="at">initialSamplings =</span> <span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">48</span>, <span class="dv">72</span>, <span class="dv">120</span> ),</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>                                                      <span class="at">numberOfTimesByWindows =</span> <span class="fu">c</span>( <span class="dv">2</span>, <span class="dv">2</span> ),</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>                                                      <span class="at">samplingsWindows =</span> <span class="fu">list</span>( <span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">48</span> ), <span class="fu">c</span>( <span class="dv">72</span>, <span class="dv">120</span> ) ),</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>                                                      <span class="at">minSampling =</span> <span class="dv">5</span> )</span></code></pre></div>
</div>
<div id="create-the-constraint-arm-and-the-associated-design" class="section level3">
<h3>Create the constraint arm and the associated design</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>arm2 <span class="ot">=</span> <span class="fu">Arm</span>( <span class="at">name =</span> <span class="st">&quot;arm2&quot;</span>,</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">150</span>,</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>            <span class="at">administrations =</span> <span class="fu">list</span>( administrationRespPK ) ,</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>            <span class="at">samplingTimes   =</span> <span class="fu">list</span>( samplingTimesRespPK ),</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>            <span class="at">samplingTimesConstraints =</span> <span class="fu">list</span>( samplingConstraintsRespPK ) )</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>design2 <span class="ot">=</span> <span class="fu">Design</span>( <span class="at">name =</span> <span class="st">&quot;design2&quot;</span>, <span class="at">arms =</span> <span class="fu">list</span>( arm2 ), <span class="at">numberOfArms =</span> <span class="dv">150</span> )</span></code></pre></div>
</div>
<div id="set-the-the-parameters-of-the-pso-algorithm-and-run-the-algorithm-for-the-design-optimization-with-a-population-fim" class="section level3">
<h3>Set the the parameters of the PSO algorithm and run the algorithm
for the design optimization with a population FIM</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>optimization <span class="ot">=</span> <span class="fu">Optimization</span>( <span class="at">name =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>                             </span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>                             <span class="at">modelFromLibrary =</span> modelFromLibrary,</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>                             <span class="at">modelParameters =</span> modelParameters,</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>                             <span class="at">modelError =</span> modelError,</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>                             </span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>                             <span class="at">optimizer =</span> <span class="st">&quot;PSOAlgorithm&quot;</span>,</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>                             </span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>                             <span class="at">optimizerParameters =</span> <span class="fu">list</span>(</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>                               <span class="at">maxIteration =</span> <span class="dv">100</span>,</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>                               <span class="at">populationSize =</span> <span class="dv">10</span>,</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>                               <span class="at">personalLearningCoefficient =</span> <span class="fl">2.05</span>,</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>                               <span class="at">globalLearningCoefficient =</span> <span class="fl">2.05</span>,</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>                               <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>                               <span class="at">showProcess =</span> T  ),</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>                             </span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>                             <span class="at">designs =</span> <span class="fu">list</span>( design2 ),</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a>                             </span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a>                             <span class="at">fimType =</span> <span class="st">&quot;population&quot;</span>,</span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a>                             </span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a>                             <span class="at">outputs =</span> <span class="fu">list</span>( <span class="st">&quot;RespPK&quot;</span>) )</span></code></pre></div>
</div>
<div id="run-the-pso-algorithm-for-the-optimization-with-a-population-fim" class="section level3">
<h3>Run the PSO algorithm for the optimization with a population
FIM</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>optimizationPSO <span class="ot">=</span> <span class="fu">run</span>( optimization )</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="fu">saveRDS</span>( optimizationPSO, <span class="st">&quot;optimizationPSO.RDS&quot;</span> )</span></code></pre></div>
</div>
<div id="display-the-results-of-the-design-optimization" class="section level3">
<h3>Display the results of the design optimization</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="fu">show</span>( optimizationPSO )</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>fisherMatrix <span class="ot">=</span> <span class="fu">getFisherMatrix</span>( optimizationPSO )</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="fu">getCorrelationMatrix</span>( optimizationPSO )</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="fu">getSE</span>( optimizationPSO )</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="fu">getRSE</span>( optimizationPSO )</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="fu">getShrinkage</span>( optimizationPSO )</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="fu">getDeterminant</span>( optimizationPSO )</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="fu">getDcriterion</span>( optimizationPSO )</span></code></pre></div>
</div>
<div id="create-and-save-the-report-for-the-design-optimization" class="section level3">
<h3>Create and save the report for the design optimization</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>outputPath <span class="ot">=</span> <span class="st">&quot;C:/...&quot;</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>outputFile <span class="ot">=</span> <span class="st">&quot;Example02_OptimizationPSOPopFIM.html&quot;</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="fu">Report</span>( optimizationPSO, outputPath, outputFile, plotOptions )</span></code></pre></div>
</div>
<div id="set-the-the-parameters-of-the-pgbo-algorithm-and-run-the-algorithm-for-the-design-optimization-with-a-population-fim" class="section level3">
<h3>Set the the parameters of the PGBO algorithm and run the algorithm
for the design optimization with a population FIM</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>optimizationPGBO <span class="ot">=</span> <span class="fu">Optimization</span>( <span class="at">name =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>                                 <span class="at">modelFromLibrary =</span> modelFromLibrary,</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>                                 <span class="at">modelParameters =</span> modelParameters,</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>                                 <span class="at">modelError =</span> modelError,</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>                                 </span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>                                 <span class="at">optimizer =</span> <span class="st">&quot;PGBOAlgorithm&quot;</span>,</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>                                 </span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>                                 <span class="at">optimizerParameters =</span> <span class="fu">list</span>(</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>                                   <span class="at">N =</span> <span class="dv">30</span>,</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>                                   <span class="at">muteEffect =</span> <span class="fl">0.65</span>,</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>                                   <span class="at">maxIteration =</span> <span class="dv">1000</span>,</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a>                                   <span class="at">purgeIteration =</span> <span class="dv">200</span>,</span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>                                   <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>                                   <span class="at">showProcess =</span> <span class="cn">TRUE</span>  ),</span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a>                                 </span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a>                                 <span class="at">designs =</span> <span class="fu">list</span>( design2 ),</span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a>                                 </span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a>                                 <span class="at">fimType =</span> <span class="st">&quot;population&quot;</span>,</span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a>                                 </span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a>                                 <span class="at">outputs =</span> <span class="fu">list</span>( <span class="st">&quot;RespPK&quot;</span>) )</span></code></pre></div>
</div>
<div id="run-the-pgbo-algorithm-for-the-optimization-with-a-population-fim" class="section level3">
<h3>Run the PGBO algorithm for the optimization with a population
FIM</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>optimizationPGBO <span class="ot">=</span> <span class="fu">run</span>( optimizationPGBO )</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="fu">saveRDS</span>( optimizationPGBO, <span class="st">&quot;optimizationPGBO.RDS&quot;</span> )</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>fisherMatrix <span class="ot">=</span> <span class="fu">getFisherMatrix</span>( optimizationPGBO )</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="fu">getCorrelationMatrix</span>( optimizationPGBO )</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="fu">getSE</span>( optimizationPGBO )</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="fu">getRSE</span>( optimizationPGBO )</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="fu">getShrinkage</span>( optimizationPGBO )</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="fu">getDeterminant</span>( optimizationPGBO )</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="fu">getDcriterion</span>( optimizationPGBO )</span></code></pre></div>
</div>
<div id="display-the-results-of-the-design-optimization-1" class="section level3">
<h3>Display the results of the design optimization</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">show</span>( optimizationPGBO )</span></code></pre></div>
</div>
<div id="create-and-save-the-report-for-the-design-optimization-1" class="section level3">
<h3>Create and save the report for the design optimization</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>outputPath <span class="ot">=</span> <span class="st">&quot;C:/...&quot;</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>outputFile <span class="ot">=</span> <span class="st">&quot;Example02_OptimizationPGBOPopFIM.html&quot;</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="fu">Report</span>( optimizationPGBO, outputPath, outputFile, plotOptions )</span></code></pre></div>
</div>
</div>
<div id="set-the-the-parameters-of-the-simplex-algorithm-and-run-the-algorithm-for-the-design-optimization-with-a-population-fim" class="section level1">
<h1>Set the the parameters of the Simplex algorithm and run the
algorithm for the design optimization with a population FIM</h1>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>optimizationSimplex <span class="ot">=</span> <span class="fu">Optimization</span>( <span class="at">name =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>                                   <span class="at">modelFromLibrary =</span> modelFromLibrary,</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>                                   <span class="at">modelParameters =</span> modelParameters,</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>                                   <span class="at">modelError =</span> modelError,</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>                                   </span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>                                   <span class="at">optimizer =</span> <span class="st">&quot;SimplexAlgorithm&quot;</span>,</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>                                   </span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>                                   <span class="at">optimizerParameters =</span> <span class="fu">list</span>( <span class="at">pctInitialSimplexBuilding =</span> <span class="dv">10</span>,</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>                                                               <span class="at">maxIteration =</span> <span class="dv">1000</span>,</span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>                                                               <span class="at">tolerance =</span> <span class="fl">1e-10</span>,</span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>                                                               <span class="at">showProcess =</span> <span class="cn">TRUE</span>  ),</span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a>                                   </span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a>                                   <span class="at">designs =</span> <span class="fu">list</span>( design2 ),</span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a>                                   </span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a>                                   <span class="at">fimType =</span> <span class="st">&quot;population&quot;</span>,</span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a>                                   </span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a>                                   <span class="at">outputs =</span> <span class="fu">list</span>( <span class="st">&quot;RespPK&quot;</span>) )</span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a>optimizationSimplex <span class="ot">=</span> <span class="fu">run</span>( optimizationSimplex )</span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a><span class="fu">saveRDS</span>( optimizationSimplex, <span class="st">&quot;optimizationSimplex.RDS&quot;</span> )</span></code></pre></div>
<div id="display-the-results-of-the-design-optimization-2" class="section level3">
<h3>Display the results of the design optimization</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">show</span>( optimizationSimplex )</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>fisherMatrix <span class="ot">=</span> <span class="fu">getFisherMatrix</span>( optimizationSimplex )</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a><span class="fu">getCorrelationMatrix</span>( optimizationSimplex )</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="fu">getSE</span>( optimizationSimplex )</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="fu">getRSE</span>( optimizationSimplex )</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="fu">getShrinkage</span>( optimizationSimplex )</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a><span class="fu">getDeterminant</span>( optimizationSimplex )</span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="fu">getDcriterion</span>( optimizationSimplex )</span></code></pre></div>
</div>
<div id="create-and-save-the-report-for-the-design-optimization-2" class="section level3">
<h3>Create and save the report for the design optimization</h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>outputPath <span class="ot">=</span> <span class="st">&quot;C:/...&quot;</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>outputFile <span class="ot">=</span> <span class="st">&quot;Example02_OptimizationSimplexPopFIM.html&quot;</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a><span class="fu">Report</span>( optimizationSimplex, outputPath, outputFile, plotOptions )</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a><span class="fu">saveRDS</span>( optimizationSimplex, <span class="at">file =</span> <span class="fu">paste0</span>( outputPath, <span class="st">&quot;Example02_OptimizationSimplexPopFIM.rds&quot;</span> ) )</span></code></pre></div>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Sukeishi2021" class="csl-entry">
Sukeishi, Asami, Kotaro Itohara, Atsushi Yonezawa, Yuki Sato, Katsuyuki
Matsumura, Yoshiki Katada, Takayuki Nakagawa, et al. 2022.
<span>“Population Pharmacokinetic Modeling of GS-441524, the Active
Metabolite of Remdesivir, in Japanese COVID-19 Patients with Renal
Dysfunction.”</span> <em>CPT: Pharmacometrics &amp; Systems
Pharmacology</em> 11 (1): 94–103.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
